<!DOCTYPE html>
<html>
<head>
	<title>browser-amd-editor</title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<script src="../jquery.js"></script>
</head>
<body style="overflow-x: hidden;overflow-y: hidden;">
<script>

	document.write(`<div id="container" style="overflow-x: hidden;overflow-y: hidden;width: 100vw;height:400px;"></div>`)
</script>

<!-- OR ANY OTHER AMD LOADER HERE INSTEAD OF loader.js -->
<script src="./monaco-editor/min/vs/loader.js"></script>
<script>
	require.config({paths: {vs: './monaco-editor/min/vs'}});

	require(['vs/editor/editor.main'], function () {

		const myEditor = monaco.editor.create(document.getElementById('container'), {
			value: `{aassa}`,
			language: 'css'
		});
		var nowHeight = 0

		function getNowHeight() {
			nowHeight = document.querySelectorAll('.view-line').length
		}

		setTimeout(() => {
			getNowHeight()
		}, 100)
		// 监听文本变化事件
		// myEditor.onDidChangeModelContent(function (event) {
		// 	// 获取更改内容
		// 	var changes = event.changes;
		// 	// 遍历更改内容
		// 	for (var i = 0; i < changes.length; i++) {
		// 		var change = changes[i];
		// 		console.log('change:', change.range)
		// 		console.log(`change.text:`,change.text)
		// 		if ((myEditor.getModel().getLineContent(1)!=='style {')
		// 				||
		// 				(myEditor.getModel().getLineContent(myEditor.getModel().getLineCount())!=='}')
		// 		) {
		// 			myEditor.getModel().undo()
		// 		}
		// 		getNowHeight()
		// 		// myEditor.getModel().undo()
		// 		// 检查是否为删除操作
		// 		// if (change.text === "" && change.rangeLength > 0) {
		// 		//     var line = change.range.startLineNumber;
		// 		//     var column = change.range.startColumn;
		// 		//     // 禁止删除操作
		// 		//     myEditor.executeEdits("preventDelete", [{ range: change.range, text: "" }]);
		// 		// }
		// 	}
		// });
		// myEditor.onKeyDown(function (e) {
		// 	if (e.keyCode === monaco.KeyCode.Delete || e.keyCode === monaco.KeyCode.Backspace) {
		// 		getNowHeight()
		// 	}
		// });
		// // 添加內容變化的監聽器
		// myEditor.onDidChangeModelContent(function (event) {
		// 	// 當內容發生變化時，觸發這個回調函數
		// 	var newValue = {
		// 		callbackID:getUrlParameter('callbackID'),
		// 		value:myEditor.getValue()
		// 	}; // 獲取當前的內容
		// 	console.log("內容已變化：", newValue);
		// 	parent.postMessage(
		// 			{
		// 				type: 'dataChange',
		// 				data: newValue,
		// 			},
		// 			targetOrigin
		// 	);
		// });
	});

</script>
</body>
</html>
